\documentclass{tufte-book}
\usepackage{listings}
\usepackage{syntax}
\usepackage[normalem]{ulem}

\setlength{\grammarparsep}{1pt plus 1pt minus 1pt} % increase separation between rules
\setlength{\grammarindent}{1em} % increase separation between LHS/RHS 
\setcounter{secnumdepth}{4}
\definecolor{keyword1}{rgb}{0,0.2,0.7}
\definecolor{keyword2}{rgb}{0.53, 0.06, 0.58}
\definecolor{keyword3}{gray}{0.1}
\definecolor{string}{rgb}{0.459, 0.592, 0.141}
\definecolor{mygray}{gray}{0.6}
\definecolor{lbcolor}{rgb}{0.9,0.9,0.9}
\definecolor{bgBash}{rgb}{0.99,0.9,0.9}
\definecolor{bgHL}{rgb}{0.9,0.9,0.99}
\definecolor{bgJava}{rgb}{0.9,0.99,0.9}


\lstset{
mathescape=false,
numbers=left, numberstyle=\small, stepnumber=1, numbersep=5pt,
backgroundcolor=\color{yellow!10}, frame=single
}

\lstset{% general command to set parameter(s)
	basicstyle=\small, % print whole listing small
	% underlined bold black keywords
	identifierstyle=, % nothing happens
	commentstyle=\color{gray}, % white comments
	stringstyle=\ttfamily, % typewriter type for strings
	showstringspaces=false,
	keywordstyle=\color{keyword1}\bfseries,
	keywordstyle=[2]{\color{keyword2}\bfseries},
	keywordstyle=[3]{\color{keyword3}\bfseries}
} % no special string spaces

\lstdefinelanguage{HadraLang}
{
	% list of keywords
	morekeywords={
		import,
		if,else,catch,try,finally,
		while, for,break,contiue,case,switch,is,
		class,def,void,abstract, 
		public,private,protected,static,synchronized,
		boolean,byte,short,int,long,float,double,char,
		null,
		this,super,operator,return		
	},
	morekeywords=[2]{
		main,get,set,init,value,println
	},
	morekeywords=[3]{
		String,StringBuilder,StringBuffer
		,Date,LocalDate,LocalTime,LocalDateTime
		,BigDecimal,BigInteger,Object,Math,length
	},
	sensitive=true, % keywords are not case-sensitive
	morecomment=[l]{//}, % l is for line comment
	morecomment=[s]{/*}{*/}, % s is for start and end delimiter
	morestring=[b]" % defines that strings are enclosed in double quotes
	morestring=[b]'
	morestring=[b]`
}

	\newcommand{\CodeJava}[1]{
	\lstset{language=Java,backgroundcolor=\color{bgJava}}
	#1
	}
	\newcommand{\CodeHadra}[1]{
	\lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
	#1
	}
	\newcommand{\CodeBash}[1]{
	\lstset{language=Bash,backgroundcolor=\color{bgBash}}
	#1
	}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\hypersetup{colorlinks}% uncomment this line if you prefer colored hyperlinks (e.g., for onscreen viewing)

%%
% Book metadata
\title{Hadra-Lang v0.1 Book\thanks{Thanks to Edward R.~Tufte for his template.}}
\author[Taha BEN SALAH]{Taha BEN SALAH}
\publisher{Sousse University, ENISo}

%%
% If they're installed, use Bergamo and Chantilly from www.fontsite.com.
% They're clones of Bembo and Gill Sans, respectively.
%\IfFileExists{bergamo.sty}{\usepackage[osf]{bergamo}}{}% Bembo
%\IfFileExists{chantill.sty}{\usepackage{chantill}}{}% Gill Sans

%\usepackage{microtype}

%%
% Just some sample text
\usepackage{lipsum}

%%
% For nicely typeset tabular material
\usepackage{booktabs}

%%
% For graphics / images
\usepackage{graphicx}
\setkeys{Gin}{width=\linewidth,totalheight=\textheight,keepaspectratio}
\graphicspath{{graphics/}}

% The fancyvrb package lets us customize the formatting of verbatim
% environments.  We use a slightly smaller font.
\usepackage{fancyvrb}
\fvset{fontsize=\normalsize}

%%
% Prints argument within hanging parentheses (i.e., parentheses that take
% up no horizontal space).  Useful in tabular environments.
\newcommand{\hangp}[1]{\makebox[0pt][r]{(}#1\makebox[0pt][l]{)}}

%%
% Prints an asterisk that takes up no horizontal space.
% Useful in tabular environments.
\newcommand{\hangstar}{\makebox[0pt][l]{*}}

%%
% Prints a trailing space in a smart way.
\usepackage{xspace}

%%
% Some shortcuts for Tufte's book titles.  The lowercase commands will
% produce the initials of the book title in italics.  The all-caps commands
% will print out the full title of the book in italics.
\newcommand{\vdqi}{\textit{VDQI}\xspace}
\newcommand{\ei}{\textit{EI}\xspace}
\newcommand{\ve}{\textit{VE}\xspace}
\newcommand{\be}{\textit{BE}\xspace}
\newcommand{\VDQI}{\textit{The Visual Display of Quantitative Information}\xspace}
\newcommand{\EI}{\textit{Envisioning Information}\xspace}
\newcommand{\VE}{\textit{Visual Explanations}\xspace}
\newcommand{\BE}{\textit{Beautiful Evidence}\xspace}

\newcommand{\TL}{Tufte-\LaTeX\xspace}

% Prints the month name (e.g., January) and the year (e.g., 2008)
\newcommand{\monthyear}{%
	\ifcase\month\or January\or February\or March\or April\or May\or June\or
	July\or August\or September\or October\or November\or
	December\fi\space\number\year
}


% Prints an epigraph and speaker in sans serif, all-caps type.
\newcommand{\openepigraph}[2]{%
	%\sffamily\fontsize{14}{16}\selectfont
	\begin{fullwidth}
		\sffamily\large
		\begin{doublespace}
			\noindent\allcaps{#1}\\% epigraph
			\noindent\allcaps{#2}% author
		\end{doublespace}
	\end{fullwidth}
}

% Inserts a blank page
\newcommand{\blankpage}{\newpage\hbox{}\thispagestyle{empty}\newpage}

\usepackage{units}

% Typesets the font size, leading, and measure in the form of 10/12x26 pc.
\newcommand{\measure}[3]{#1/#2$\times$\unit[#3]{pc}}

% Macros for typesetting the documentation
\newcommand{\hlred}[1]{\textcolor{Maroon}{#1}}% prints in red
\newcommand{\hangleft}[1]{\makebox[0pt][r]{#1}}
\newcommand{\hairsp}{\hspace{1pt}}% hair space
\newcommand{\hquad}{\hskip0.5em\relax}% half quad space
\newcommand{\TODO}{\textcolor{red}{\bf TODO!}\xspace}
\newcommand{\na}{\quad--}% used in tables for N/A cells
\providecommand{\XeLaTeX}{X\lower.5ex\hbox{\kern-0.15em\reflectbox{E}}\kern-0.1em\LaTeX}
\newcommand{\tXeLaTeX}{\XeLaTeX\index{XeLaTeX@\protect\XeLaTeX}}
% \index{\texttt{\textbackslash xyz}@\hangleft{\texttt{\textbackslash}}\texttt{xyz}}
\newcommand{\tuftebs}{\symbol{'134}}% a backslash in tt type in OT1/T1
\newcommand{\doccmdnoindex}[2][]{\texttt{\tuftebs#2}}% command name -- adds backslash automatically (and doesn't add cmd to the index)
\newcommand{\doccmddef}[2][]{%
	\hlred{\texttt{\tuftebs#2}}\label{cmd:#2}%
	\ifthenelse{\isempty{#1}}%
	{% add the command to the index
		\index{#2 command@\protect\hangleft{\texttt{\tuftebs}}\texttt{#2}}% command name
	}%
	{% add the command and package to the index
		\index{#2 command@\protect\hangleft{\texttt{\tuftebs}}\texttt{#2} (\texttt{#1} package)}% command name
		\index{#1 package@\texttt{#1} package}\index{packages!#1@\texttt{#1}}% package name
	}%
}% command name -- adds backslash automatically
\newcommand{\doccmd}[2][]{%
	\texttt{\tuftebs#2}%
	\ifthenelse{\isempty{#1}}%
	{% add the command to the index
		\index{#2 command@\protect\hangleft{\texttt{\tuftebs}}\texttt{#2}}% command name
	}%
	{% add the command and package to the index
		\index{#2 command@\protect\hangleft{\texttt{\tuftebs}}\texttt{#2} (\texttt{#1} package)}% command name
		\index{#1 package@\texttt{#1} package}\index{packages!#1@\texttt{#1}}% package name
	}%
}% command name -- adds backslash automatically
\newcommand{\docopt}[1]{\ensuremath{\langle}\textrm{\textit{#1}}\ensuremath{\rangle}}% optional command argument
\newcommand{\docarg}[1]{\textrm{\textit{#1}}}% (required) command argument
\newenvironment{docspec}{\begin{quotation}\ttfamily\parskip0pt\parindent0pt\ignorespaces}{\end{quotation}}% command specification environment
\newcommand{\docenv}[1]{\texttt{#1}\index{#1 environment@\texttt{#1} environment}\index{environments!#1@\texttt{#1}}}% environment name
\newcommand{\docenvdef}[1]{\hlred{\texttt{#1}}\label{env:#1}\index{#1 environment@\texttt{#1} environment}\index{environments!#1@\texttt{#1}}}% environment name
\newcommand{\docpkg}[1]{\texttt{#1}\index{#1 package@\texttt{#1} package}\index{packages!#1@\texttt{#1}}}% package name
\newcommand{\doccls}[1]{\texttt{#1}}% document class name
\newcommand{\docclsopt}[1]{\texttt{#1}\index{#1 class option@\texttt{#1} class option}\index{class options!#1@\texttt{#1}}}% document class option name
\newcommand{\docclsoptdef}[1]{\hlred{\texttt{#1}}\label{clsopt:#1}\index{#1 class option@\texttt{#1} class option}\index{class options!#1@\texttt{#1}}}% document class option name defined
\newcommand{\docmsg}[2]{\bigskip\begin{fullwidth}\noindent\ttfamily#1\end{fullwidth}\medskip\par\noindent#2}
\newcommand{\docfilehook}[2]{\texttt{#1}\index{file hooks!#2}\index{#1@\texttt{#1}}}
\newcommand{\doccounter}[1]{\texttt{#1}\index{#1 counter@\texttt{#1} counter}}

% Generates the index
\usepackage{makeidx}
\makeindex


\begin{document}

    % Front matter
    \frontmatter

    % r.1 blank page
    \newpage

    This is a draft document. it is very incomplete...
    \newline
     Hadra Language Version 0.0.1.1
    \newline
     buit on 2020-06-14
    \newline
     Document Version 0.0.1
    \newline
     buit on 2020-06-14
    \newline

    \blankpage

    % v.2 epigraphs
    \newpage\thispagestyle{empty}
    \openepigraph{%
        The public is more familiar with bad design than good design.
        It is, in effect, conditioned to prefer bad design, 
        because that is what it lives with. 
        The new becomes threatening, the old reassuring.
    }{Paul Rand%, {\itshape Design, Form, and Chaos}
    }
    \vfill
    \openepigraph{%
        A designer knows that he has achieved perfection 
        not when there is nothing left to add, 
        but when there is nothing left to take away.
    }{Antoine de Saint-Exup\'{e}ry}
    \vfill
    \openepigraph{%
        \ldots the designer of a new system must not only be the implementor and the first 
        large-scale user; the designer should also write the first user manual\ldots 
        If I had not participated fully in all these activities, 
        literally hundreds of improvements would never have been made, 
        because I would never have thought of them or perceived 
        why they were important.
    }{Donald E. Knuth}


    % r.3 full title page
    \maketitle

    % r.1 blank page
    \newpage

    \openepigraph{%
        Contributors :
    }{%, {\itshape Design, Form, and Chaos}
    }

    \openepigraph{ thevpc
    }{
        designer, developer, maintainer
    }
 

    
    % v.4 copyright page
    \newpage
    \begin{fullwidth}
        ~\vfill
        \thispagestyle{empty}
        \setlength{\parindent}{0pt}
        \setlength{\parskip}{\baselineskip}
        Copyright \copyright\ \the\year\ \thanklessauthor
        
        \par\smallcaps{Published by \thanklesspublisher}
        
        \par\smallcaps{github.io/thevpc/hadralang}
        
        \par Licensed under the Apache License, Version 3.0 (the ``License''); you may not
        use this file except in compliance with the License. You may obtain a copy
        of the License at \url{http://www.apache.org/licenses/LICENSE-3.0}. Unless
        required by applicable law or agreed to in writing, software distributed
        under the License is distributed on an \smallcaps{``AS IS'' BASIS, WITHOUT
            WARRANTIES OR CONDITIONS OF ANY KIND}, either express or implied. See the
        License for the specific language governing permissions and limitations
        under the License.\index{license}
        
        \par\textit{First printing, \monthyear}
    \end{fullwidth}

    % r.5 contents
    \tableofcontents

    \listoffigures

    \listoftables

    % r.7 dedication
    \cleardoublepage
    ~\vfill
    \begin{doublespace}
        \noindent\fontsize{18}{22}\selectfont\itshape
        \nohyphenation
        Dedicated to my fabulous family.
    \end{doublespace}
    \vfill
    \vfill


    % r.9 introduction
    \cleardoublepage
    \chapter*{Introduction}

        \textit{HadraLang} is a new GPL for DSL, multi paradigm, statically typed, transpiled, programming language that is very inspired from Java, C\#, C++, Scala, Kotlin and Haskell among other programming languages around. HadraLang (or **HL**) compiles mainly to java source code or directly to java bytecode. By GPL for DSL we mean a general purpose programming language that makes it easy to be used as a Domain Specific Language in a range of domains. 
        
        \textit{HadraLang} is entended to be
        \begin{itemize}
        \item easy to learn for DSL users
        \item more precise semantics
        \item with better checking : compiler should do more work
        \item focus conciseness : write less, do more
        \item promote readability : meaningful statements
        \item enable extensibility : always make room for extensions
        \end{itemize}

        and brings features like
        \begin{itemize}
        \item Single file project
        \item Embeddable scripting
        \item Transpillable to a range of Languages (for now only Java is supported)
        \item Preprocessing
        \item Operator overloading with unicode support
        \item Extension of existing classes
        \item Extension of control statements
        \item null safety operators
        \item Checked and unchecked calls
        \item Tuples and Range support
        \end{itemize}


        \section*{Why do we need another Programming Language?}
        \textit{HadraLang} was first designed as a backing scripting language for "Hadrumaths" java/scala library which is mainly an algebraic calculus library as a replacement of the scripting facilities implemented in scala. Java and Scala are very powerful programming languages however code can get very verbose or very complicated sooner or later.        
        Initially, \textit{HadraLang} was implemented as a simple imperative programming language with operator overloading, implicit conversion, and extension functions with support for unicode operators (used in algebra calculus). There we have seen the potential of such programming language as a GPL be re-sesigning the language to becore multi-paradigm.
        
        
        \section*{Hello World}
        Writing a Hello world in \textit{HadraLang} is straightforward. There is no need to encapsulate your code in a function/procedure/class or whatsoever.
        The following code is a fully compilable/runnable valid code :
        
        \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
        \begin{lstlisting}
println("Hello World");
        \end{lstlisting}
        
        Assuming this line of code is saved to "Main.hl", we need to compile it and run it using this command:
        \lstset{language=Bash,backgroundcolor=\color{bgBash}}
        \begin{lstlisting}
$ hl Main.hl
        \end{lstlisting}

        This command will actually compile the code, generate the corresponding byte code and execute it a new virtual machine.
        
        If we need only to compile the file to a jar we issue this command:

        \lstset{backgroundcolor=\color{bgBash}}
        \begin{lstlisting}
$ hl --jar Main.hl
        \end{lstlisting}

        \section*{Getting Started}
        To use \textit{HadraLang} we need to download the \textit{HadraLang} Compiler and Runtime. The easiest way to do so is via \textit{nuts} package manager. Both \textit{nuts} and \textit{HadraLang} are written in \textit{java} (c) and require \textit{java} 8 runtime (or later).
        We start checking if java is installed :
        \begin{lstlisting}
$ java -version
java version %221.8.0_211%22
Java(TM) SE Runtime Environment (build 1.8.0_211-b12)
Java HotSpot(TM) 64-Bit Server VM (build 25.211-b12, mixed mode)
        \end{lstlisting}
        If we have not nuts installed yet, we start downloading nuts and installing it as show here.
        We download nuts binaries, a bare jar file.
         \lstset{language=Bash,backgroundcolor=\color{bgBash}}
        \begin{lstlisting}
$ wget https://github.com/thevpc/vpc-public-maven\
/raw/master/net/vpc/app/nuts/nuts/0.7.0/nuts-0.7.0.jar
        \end{lstlisting}
Then we run the installer :
        \begin{lstlisting}
$ java -jar nuts-0.7.0.jar
        \end{lstlisting}
        
        make sure you close and re-open you console after installing nuts for the environment to be configured correctly.
        
        Once you have nuts installed on one's machine, we issue this command to install \textit{HadraLang} compiler and runtime.

        \begin{lstlisting}
$ nuts -y install hl
        \end{lstlisting}
        
        running Hello world
        \begin{lstlisting}
$ hl Main.hl
        \end{lstlisting}
        
        %%
        % Start the main matter (normal chapters)
        \mainmatter

        bla bla bla
    
    \part{Reference Guide}

        \chapter{Lexical Structure}
            bla bla bla
            \section{Lexical Program Structure}
            bla bla bla
            \section{Comments}
            \section{Keywords}
            
            \begin{center}
                \begin{tabular}{ c c c c c c}
                    abstract & assert & boolean & break & byte & case \\
catch & char & class & continue & default & do \\
double & else & enum & extends & final & finally \\
float & for & if & \sout{implements} &  import & \sout{instanceof} \\
int & interface & long & native & new & null \\
package & private & protected & public & return & short \\
 static & strictfp & super & switch & synchronized & this \\
throw & \sout{throws} & transient & try & void & volatile \\
while & \textbf{is} & \textbf{def} & \textbf{constructor} & \textbf{operator}
                \end{tabular}
            \end{center}
            
            bla bla bla
            \section{Literals}
            bla bla bla
            \subsection{Numerical Literals}
int type            
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
\begin{lstlisting}
int twelveDecimal=12;
int oneThousand=1_000;
int sixteenHexa=0x10;
int sixteenOctal=020;
int sixteenBinary=0b10000;
\end{lstlisting}

            
long type            
\lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
\begin{lstlisting}
long twelveDecimal=12L;
long oneThousand=1_000L;
long sixteenHexa=0x10L;
int sixteenOctal=020L;
long sixteenBinary=0b10000L;
\end{lstlisting}

            
byte type            
\lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
\begin{lstlisting}
byte twelveDecimal=12b;
byte oneHandred=1_00b;
byte sixteenHexa=0x10b;
byte sixteenOctal=020b;
byte sixteenBinary=0b10000b;
\end{lstlisting}

            
short type            
\lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
\begin{lstlisting}
short twelveDecimal=12S;
short oneHandred=1_00S;
short sixteenHexa=0x10S;
short sixteenOctal=020S;
short sixteenBinary=0b10000S;
\end{lstlisting}
            
big integer type            
\lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
\begin{lstlisting}
BigInteger twelveDecimal=12B;
BigInteger oneHandred=1_00B;
BigInteger sixteenHexa=0x10B;
BigInteger sixteenOctal=020B;
BigInteger sixteenBinary=0b10000B;
\end{lstlisting}

float type            
\lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
\begin{lstlisting}
float twelveDecimal=12.0f;
float oneHandred=1_00f;
\end{lstlisting}

double type            
\lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
\begin{lstlisting}
double twelveDecimal=12.0d;
double oneHandred=1_00d;
\end{lstlisting}


big decimal type            
\lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
\begin{lstlisting}
BigDecimal twelveDecimal=12.0D;
BigDecimal oneHandred=1_00D;
\end{lstlisting}

\subsection{Character and String Literals}
            bla bla bla
            \subsection{Temporal Literals}

            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
LocalDate d=t"2020-02-01";
LocalDateTime dt=t"2020-02-01T12:00";
LocalTime t=t"12:00";
            \end{lstlisting}

            \subsection{Pattern Literals}
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
if (p"[0-9]+".matches("12")){
    println("12 is a number");
}
if (p"[0-9]+" ~ "12"){
    println("12 is a number");
}
if ("12" ~ p"[0-9]+"){
    println("12 is a number");
}
            \end{lstlisting}
            \subsection{Interpolated String Literals}
            \begin{lstlisting}
int x=12; 
String s1="Hello";
String s2="World";
println($"$s1 ${s2} for number $x");
            \end{lstlisting}
            \section{Identifiers}
            \section{Operators}
            \subsection{== operator}
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
String s1="hello";
String s2(s1);
if(s1==s1){
    println("this is true.");
}
if(null==s1){
    println("this is false.");
}
            \end{lstlisting}


            \subsection{=== operator}
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
String s1="hello";
String s2(s1);
if(s1==s1){
    println("this is always true. null safe 'equals' will be called");
}
if(s1===s1){
    println("this is false. ref equality will be used");
}
            \end{lstlisting}


            \subsection{'.' member operator}
            
            \begin{lstlisting}
Person p;
println(p.address.street.name);
            \end{lstlisting}

            \subsection{'?' null expression member operator}
            
            \begin{lstlisting}
Person p;
println(p?address?street?name);
            \end{lstlisting}


            \subsection{'??' null member operator}
            
            \begin{lstlisting}
            Person p;
            println(p??"null");
            \end{lstlisting}


            \subsection{'?.' Operator (unchecked member)}
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
Person p;
Object o=p;
println(o.?address.?street.?name);
println(o.?address.?street.?"name");
String attrName="name";
println(o.?address.?street.?attrName);


            \end{lstlisting}

            \subsection{'()' Operator (apply)}
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
TODO
            \end{lstlisting}

            \subsection{'[]' Operator (indexed)}
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
TODO
            \end{lstlisting}

            \subsection{'??=' Operator (set if not default)}
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
String a="hello";
String b=null;
String c??=b;
            \end{lstlisting}

            \section{Tuples}
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
Tuple2<int,int> x=(1,2);
Tuple<int,int> x=(1,2);
<int,int> x=(1,2);
            \end{lstlisting}

            Tuple deconstructors
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
int x,y;
(x,y)=m();
(x,y)=(y,x);
def m()->(1,2);
            \end{lstlisting}

            \section{Arrays}

                Left Hand Side matching
                \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
                \begin{lstlisting}
int[10] x(i->i);
x[0..2]=[15,20,30];
x[0..2]=x[5..7];
                \end{lstlisting}


                Right Hand Side matching
                \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
                \begin{lstlisting}
int[10] x(i->i);
int[] y=x[5..7];
                \end{lstlisting}

                Array Length
                \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
                \begin{lstlisting}
int[10] a;
int[10] a(3);
int[10] a(x->Math.random());
int[10] a(Math::random);
                \end{lstlisting}

            \section{Type conversion and cast}
            Hadra Language uses intensively conversions whenever possible. So type conversion is at the heart of the language.
            Type conversion can either create a new instance or retain the same one (when downcasting/upcasting).
            Conversion is done via one of three mechanisms :
            down/up casting
            constructor call
            converter call.
            The compiler will always check one of this three alternative in a Specific order to be defined.
            BEsides, a type conversion can be lenient or not. when linient, failing to convert will return null, otherwise it will generate an exception at compile time.
            
            B b=(B)a;
            can be achieved with
            if(a is B b){
              //
            }else{
                throw ClassCastException();
            }
            
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
                \begin{lstlisting}
Fruit f;
Apple a=(Apple)f;
                \end{lstlisting}
Thr compiler will 
             \subsection{Cast First conversion}
             Tests in the order if the cast matches, than if a factory method exists and finally if a constructor exists
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
                \begin{lstlisting}
Fruit f;
Apple a=(Apple)f;
                \end{lstlisting}

             \subsection{Factory First conversion}
             Tests in the order if a factory method exists than if a constructor exists otherwise only is a cast applies
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
                \begin{lstlisting}
Fruit f;
Apple a=Apple(f);
                \end{lstlisting}
             \subsection{New First conversion}
             Tests in the order if a constructor exists then if a factory method exists otherwise only is a cast applies
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
                \begin{lstlisting}
Fruit f;
Apple a=new Apple(f);
                \end{lstlisting}
             \subsection{Lenient conversion}
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
                \begin{lstlisting}
Fruit f;
Apple a=(Apple?)f;
Apple b=Apple?(f);
Apple c=new Apple?(f);
                \end{lstlisting}

            \section{Lambda Expressions}
            
            \section{Annotations}
            TODO

        \chapter{Control-flow}
            \section{if/else syntax}
            \subsection{if statement}
            \subsection{if expression}
            \section{switch expression}

            \subsection{switch/case statement}
            \subsection{switch case statement}
            \subsection{switch is statement}
            \subsection{switch if statement}
            \subsection{switch default statement}
            \subsection{switch on Tuples}
            \subsection{switch Expression}

            \section{while loop syntax}
            \subsection{while/do statement}
            \subsection{do/while statement}
            \subsection{while/do expression}
            \subsection{do/while expression}
            \section{for loop}
            \subsection{for loop statement}
            \subsection{for iterator statement}
             loops on Iterable,Enumeration,Iterator and Streams.
             multi iterator does the cross loop
             filter the loop
            \subsection{for loop expression}
            \subsection{for iterator expression}

            \begin{grammar}

            <statement> ::= <ident> `=' <expr> 
            \alt `for' <ident> `=' <expr> `to' <expr> `do' <statement> 
            \alt `{' <stat-list> `}' 
            \alt <empty> 

            <stat-list> ::= <statement> `;' <stat-list> | <statement> 

            \end{grammar}


            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
int[10] a;
for(x=0;x<a.length;x++){
    println(x);
}
            \end{lstlisting}


            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
int[10] a;
int[10] b;
for(x:a){
    println(x);
}
for(x:a,y:b){
    println(x,y);
}
            \end{lstlisting}

            Statement Filter
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
int[10] a;
int[10] b;
for(x:a){
    println(x);
}
for(x:a,y:b;x<y){
    println(x,y);
}
            \end{lstlisting}
            For Expression:
            for expression is an enumeration comprehension that creates enumerated type that will be processed 
            at will. The result is mainly a stream that is mapped implicitly to array/List or Iterable according 
            to the given context.
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
Iterable<int> x=for(i=0;i<10;i++)->i;
IntStream<int> x=for(i=0;i<10;i++)->i;
List<int> x=for(i=0;i<10;i++)->i;
int[] x=for(i=0;i<10;i++)->i;
            \end{lstlisting}


            \section{try/catch}
            All exceptions in Hadra-Lang are uncheked. This means there is no need at compile time to add try/catch blocks. Besides Exceptions are handled both as control blocs and as expressions.

            Catch Blocs
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
            int x;
            try {
                x=int(myString);
            }catch(Exception){
                //do some thing
            }
            \end{lstlisting}


            Multi catch Blocs
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
            int x;
            try {
                x=int(myString);
            }catch(NumberFormatException
                |NullPointerException ex){
                //do some thing
            }catch(Exception e){
                //do some thing
            }
            \end{lstlisting}


            Exception variable Name
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
            int x;
            try {
                x=int(myString);
            }catch(NumberFormatException
                |NullPointerException){
                throw error;
            }catch(Exception){
                throw error;
            }
            
            \end{lstlisting}
            Catch Expressions
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
            int x = int(myString) catch 0;
            \end{lstlisting}
            
            \chapter{Declarations}
            \subsection{Classes}
            HadraLang supports Object Oriented programming by providing syntax for creating and manipulating classes and methods. All features from Java such as class initializers, instance initializers, class constructors, default constructor inheritence and visibility apply. Howerver some differences will be discussed here after.
            a class in HadraLang must start with the class keyword.
            constructor and  declared fields in on declaration statement.

            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
            class Complex{
            }
            \end{lstlisting}


            As you can see, no modifiers are required. The default modifier is \textcolor{keyword1}{public}  (by opposition to package protected in java). As a matter of fact, there is NO package protected visibility in HadraLang. For top level classes, the modifiers that apply are public and final


            \subsection{Annotation Classes}
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
            @MathType
            class Complex{
            }
            \end{lstlisting}



            \subsection{Exception Classes}
            \subsection{Enumerations}



            \subsection{Fields and Properties}

            Main Constructor Arguments
\lstset{mathescape=true}
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
class my.Complex{
    constructor(double real,double imag){
        this.real=real;
        this.imag=imag;
    }
}
            \end{lstlisting}
\lstset{mathescape=false}

            Field without Getters and Setters
\lstset{mathescape=true}
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
class my.Complex{
    double real;
    double imag;
}
            \end{lstlisting}
\lstset{mathescape=false}

            
            Default Getters and setters
\lstset{mathescape=true}
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
class my.Complex{
    double real{ get;set;}
    double image{ get;set;}
}
            \end{lstlisting}
\lstset{mathescape=false}

            
            Custom Getters and setters
\lstset{mathescape=true}
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
class my.Complex{
    //create custom getter/setter
    double real{
        get {
            println("before get");
            return this.real;
        }
        set {
            //field access because we are in the setter
            this.real=value;
        }
    }
}
            \end{lstlisting}
\lstset{mathescape=false}


            Dynamic Properties
\lstset{mathescape=true}
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
class my.Complex{
    double real;
    double imag;
    double abs{
        get->sqrt(this.real$^2$+this.imag$^2$);
    }
    double absSquare->abs*abs;
}
            \end{lstlisting}
\lstset{mathescape=false}

            
            Multiple Setters

\lstset{mathescape=true}
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
class my.Complex{
    double real;
    double imag;
    double radius {
        set{
            real=value*sin(angle);
            imag=value*cos(angle);
        }
        set(int){
            real=value*sin(angle);
            imag=value*cos(angle);
        }
        set(String s){
            set(double(s));
        }
    }
}
            \end{lstlisting}
\lstset{mathescape=false}

            Init values

\lstset{mathescape=true}
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
class my.Complex{
    double real{
        init->1;
        get;set;
    }
}
            \end{lstlisting}
\lstset{mathescape=false}


            \subsection{Builders}
builder
\lstset{mathescape=true}
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
class my.Complex(double real,double imag);
Complex c(0,0);
var r2=c.{real=0;image=5}.real;

Complex c2(0,0).{real=0;image=5};

            \end{lstlisting}
\lstset{mathescape=false}



            \subsection{Constructors}

            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
class Complex(double real,double imag){
    constructor(double real)->this(real,0);
}
            \end{lstlisting}

            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
class Complex{
    double real;
    double imag;
    constructor(double real,double imag){
        this.real=real;
        this.imag=imag;
    }
}    
            \end{lstlisting}

            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
class Complex{
    double real;
    double imag;
}
            \end{lstlisting}





            \subsection{Methods}


            Main constructors define a simple way to create a class in a very consise way. It defines the class, a default  constructor and  declared fields in on declaration statement.
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
class Complex(double real,double imag){

}
            \end{lstlisting}

            This example creates the class Complex with a couple of public fields. Actually it is equivalent to this java code

            \lstset{language=Java,backgroundcolor=\color{bgJava}}
            \begin{lstlisting}
//Equivalent Java
public class Complex(double real,double imag){
public double real;
public double imag;
public Complex(double real,double imag){
    this.real=real;
    this.imag=imag;
}

}
            \end{lstlisting}


            While the constructor itself is always public (regardless of Class visibility), fields can be secured with lower visibility modifiers :

            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
class Complex(double real,private double imag){

}
            \end{lstlisting}
            and hence the equivalent java code will be :

            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
//Equivalent Java
public class Complex(double real,double imag){
    public double real;
    private double imag;
    public Complex(double real,double imag){
        this.real=real;
        this.imag=imag;
    }

}
            \end{lstlisting}



            \subsection{Functions and global variables}
            Global functions
//global function (outside any class)
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
def void ageOf(Person p){
    return p.age;
}
class Person{
    int age;
}
            \end{lstlisting}
            main function
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
//global function (outside any class)
def void main(String[] args){
}
//or
def main(String[] args){
}
            \end{lstlisting}
            local functions
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
def void main(String[] args){
    def int max(int a,int b)->if a<b a else b
    int x=max(3,5);
}
            //or
            \end{lstlisting}


            \subsection{main function}
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
def main(String[] args){
}
            \end{lstlisting}


            \subsection{Extension functions}
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
import OtherClass.**
class my.Complex(double real,double imag){
    constructor(double real)->this(real,0);
}
//Other Compilation Unit
class OtherClass{
    def String Complex.toXml() {
        return "<xml>"+this+"</xml>";
    }
}
            \end{lstlisting}


            \subsection{Operators}

                \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
                \begin{lstlisting}
class Complex{
    //...
    static def Complex 
        operator Complex left + Complex right 
        -> left.add(other);
    def Complex operator this + Complex other -> add(other);
    def Complex operator this - Complex -> add(value);
    def Complex operator + this -> this;
    def Complex operator ++ this -> add(1);
    def Complex operator this ++ -> add(1);
}
class Matrix{
    //...
    def Complex operator this(int column,int row)
        ->get(column,row);
    def Complex operator this[int column,int row]
        ->get(column,row);
    def void operator this[int column,int row]
        =Object
        -> set(column,row,value);
}
                \end{lstlisting}

            
            \subsection{Extension constructors}
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
import OtherClass.**
class my.Complex(double real,double imag){
    constructor(double real)->this(real,0);
}
//Other Compilation Unit
class OtherClass{
        //newComplex
        constructor(String value) for my.Complex{
            return Complex(double(value));
        }
        //newIntArray2
        constructor (String value) for int[][]{
            return int[0][0];
        }
}
            \end{lstlisting}


            \subsection{Package Class}
            package declaration must appear once in the project (unlike java).
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
package com.company;
class example.MyClass{
    //effective java package is com.company.example.MyClass
}
            \end{lstlisting}


            package group and version
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
package com.company:myapp#1.0;
class example.MyClass{
    //effective java package is com.company.example.MyClass
}
            \end{lstlisting}

            modules and dependencies
//package declaration must appear once in the project (unlike java).

            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
package com.company:myapp#1.0{
    import com.lib:other#1.0 for compile;
    import com.lib:test#1.0  for test;
}
            \end{lstlisting}


        \chapter{Compilation and Execution}

            \section{PreProcessor}

            //package declaration must appear once in the project (unlike java).
            \lstset{language=HadraLang,backgroundcolor=\color{bgHL}}
            \begin{lstlisting}
package com.company:myapp#1.0{
    //effective java package is com.company.example.MyClass
}
            \end{lstlisting}

            \section{Maven Support}

            \section{Interpreter}
            \lstset{language=Bash,backgroundcolor=\color{bgBash}}
            \begin{lstlisting}
hl myfile.hl
            \end{lstlisting}

            \section{Java Transpiler/Compiler}

            \lstset{language=Bash,backgroundcolor=\color{bgBash}}
            \begin{lstlisting}
hl -c src/
            \end{lstlisting}

            \lstset{language=Bash,backgroundcolor=\color{bgBash}}
            \begin{lstlisting}
hl -j src/
            \end{lstlisting}

    \part{Programming with Hadra-Lang}
        \chapter{IDE Support}
        \section{Netbeans Support}
        blabla
        \section{Intellij Support}
        blabla
        \section{Eclipse Support}
        blabla
        
        \section{Visualcode Support}
        blabla
        \section{Other Text Tools support}
        blabla
        \chapter{Standard Library}
        \chapter{Java Integration}

    \part{Future Features}
        \section{Javascript/Typescript Transpiler}
        using [jsweet](http://www.jsweet.org)
        \lstset{language=Bash,backgroundcolor=\color{bgBash}}
        \begin{lstlisting}
hl --js src/
hl --ts src/
        \end{lstlisting}
        \section{Javascript/Typescript Transpiler}
        using [j2c](https://bitbucket.org/arnetheduck/j2c/src/default/)
        [j2c(alt)](https://github.com/arnetheduck/j2c)
        \lstset{language=Bash,backgroundcolor=\color{bgBash}}
        \begin{lstlisting}
hl --js src/
hl --ts src/
        \end{lstlisting}
        \section{Native Compiler}
        using [https://www.graalvm.org](https://www.graalvm.org)
        \lstset{language=Bash,backgroundcolor=\color{bgBash}}
        \begin{lstlisting}
hl --native src/
        \end{lstlisting}
        \section{Language Server Protocol}
        using [https://langserver.org](https://langserver.org)
        \lstset{language=Bash,backgroundcolor=\color{bgBash}}
        \begin{lstlisting}
hl --slp
        \end{lstlisting}


    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%	
    %%
    % The back matter contains appendices, bibliographies, indices, glossaries, etc.

    \backmatter

    \bibliography{hadra-lang-bib}
    \bibliographystyle{plainnat}


    \printindex
	
\end{document}
